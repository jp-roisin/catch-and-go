package components

import (
	"fmt"
	"github.com/jp-roisin/catch-and-go/cmd/web/ui/button"
	"github.com/jp-roisin/catch-and-go/cmd/web/ui/card"
	"github.com/jp-roisin/catch-and-go/internal/database/store"
)

templ LinePicker(lines []store.LineWithFallback) {
	@card.Card(
		card.Props{
			ID:    "box",
			Class: "aspect-video flex flex-col",
		}) {
		@card.Header(card.HeaderProps{Class: "pb-2"}) {
			@card.Title() {
				Find Your Route
			}
			@card.Description() {
				Select the line serving the stop you care about.
			}
		}
		@card.Content(card.ContentProps{Class: "flex-1 overflow-y-auto"}) {
			<ul class="flex flex-wrap gap-2">
				for _, line := range lines {
					<li>
						<button
							hx-get={ fmt.Sprintf("/directions/picker/%s", line.Code) }
							hx-target="#box"
							hx-swap="outerHTML"
							class="size-[40px] rounded grid place-items-center cursor-pointer font-semibold"
							style={ fmt.Sprintf("background-color:%s;color:%s", line.Color, line.TextColor) }
						>
							{ line.Code }
						</button>
					</li>
				}
			</ul>
		}
		@card.Footer(card.FooterProps{
			Class: "flex justify-end pt-2",
		}) {
			@button.Button(button.Props{
				Variant: button.VariantGhost,
				Attributes: templ.Attributes{
					"hx-get":    "/lines/empty_state",
					"hx-target": "#box",
					"hx-swap":   "outerHTML",
				},
			}) {
				Cancel
			}
		}
	}
}
