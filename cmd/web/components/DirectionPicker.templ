package components

import (
	"github.com/jp-roisin/catch-and-go/cmd/web/ui/button"
	"github.com/jp-roisin/catch-and-go/cmd/web/ui/card"
	"github.com/jp-roisin/catch-and-go/cmd/web/ui/icon"
	"github.com/jp-roisin/catch-and-go/cmd/web/ui/radiocard"
	"github.com/jp-roisin/catch-and-go/internal/database/store"
	"strconv"
)

templ DirectionPicker(lines []store.Line) {
	@card.Card(
		card.Props{
			ID:    "box",
			Class: "aspect-video flex flex-col",
		}) {
		@card.Header(card.HeaderProps{Class: "pb-2"}) {
			@card.Title() {
				Heading Which Way?
			}
			@card.Description() {
				Choose between the two endpoints of the line to see stops going that way.
			}
		}
		@card.Content(card.ContentProps{Class: "flex-1 overflow-y-auto"}) {
			<form
				class="flex flex-col gap-4"
				id="direction-form"
				hx-post="/stops/picker"
				hx-target="#box"
				hx-swap="outerHTML"
			>
				for i, line := range lines {
					@radiocard.RadioCard(radiocard.Props{
						ID:      strconv.FormatInt(int64(line.ID), 10),
						Name:    "line_id",
						Value:   strconv.FormatInt(int64(line.ID), 10),
						Checked: i == 0,
					}) {
						@radiocard.Description() {
							<div class="flex items-center gap-2">
								@icon.Navigation()
								<span>{ line.Destination }</span>
							</div>
						}
					}
				}
			</form>
		}
		@card.Footer(card.FooterProps{
			Class: "flex justify-end pt-2",
		}) {
			<div class="flex gap-2">
				@button.Button(button.Props{
					Variant: button.VariantGhost,
					Attributes: templ.Attributes{
						"hx-get":    "/lines/empty_state",
						"hx-target": "#box",
						"hx-swap":   "outerHTML",
					},
				}) {
					Cancel
				}
				@button.Button(button.Props{
					Type: "submit",
					Attributes: templ.Attributes{
						"form": "direction-form",
					},
				}) {
					Next
				}
			</div>
		}
	}
}
